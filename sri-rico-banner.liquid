{{ 'sri-rico-banner.css' | asset_url | stylesheet_tag }}

<div
  class="sri-rico-banner"
  {% if section.settings.bg_image %}
    style="--sri-rico-bg:url('{{ section.settings.bg_image | image_url: width: 3000 }}');"
  {% endif %}
>
  <div class="sri-rico-banner__inner">
    <div class="sri-rico-banner__card">
      {% if section.settings.heading != blank %}
        <h2 class="sri-rico-banner__heading">{{ section.settings.heading | escape }}</h2>
      {% endif %}

      {% if section.settings.subheading != blank %}
        <div class="sri-rico-banner__subheading rte">
          {{ section.settings.subheading }}
        </div>
      {% endif %}

      <div class="sri-rico-banner__actions">
        {% if section.settings.primary_label != blank and section.settings.primary_link != blank %}
          <a class="sri-rico-banner__btn sri-rico-banner__btn--primary" href="{{ section.settings.primary_link }}">
            {{ section.settings.primary_label | escape }}
          </a>
        {% endif %}

        {% if section.settings.use_native_paypal and section.settings.paypal_product != blank %}
          {% assign p = section.settings.paypal_product %}
          {% form 'product', p, id: 'sri-rico-paypal-form-' | append: section.id %}
            {{ form | payment_button }}
          {% endform %}
        {% elsif section.settings.secondary_label != blank %}
          {% assign secondary_href = section.settings.secondary_link | default: '#' %}
          <a class="sri-rico-banner__btn sri-rico-banner__btn--secondary" href="{{ secondary_href }}">
            <span>{{ section.settings.secondary_label | escape }}</span>
            {% if section.settings.secondary_icon %}
              {{ section.settings.secondary_icon
                | image_url: width: 140
                | image_tag: class: 'sri-rico-banner__btn-icon', loading: 'lazy', alt: section.settings.secondary_icon.alt | escape }}
            {% endif %}
          </a>
        {% endif %}
      </div>

      {% if section.settings.fine_print != blank or section.settings.fine_logo %}
        <div class="sri-rico-banner__fine">
          {% if section.settings.fine_print != blank %}
            <span class="sri-rico-banner__fine-text rte">{{ section.settings.fine_print }}</span>
          {% endif %}
          {% if section.settings.fine_logo %}
            <span class="sri-rico-banner__fine-logos">
              {{ section.settings.fine_logo
                | image_url: width: 120
                | image_tag: class: 'sri-rico-banner__fine-logo', loading: 'lazy', alt: section.settings.fine_logo.alt | escape }}
            </span>
          {% endif %}
        </div>
      {% endif %}
      
      <div class="sri-rico-banner__separator"></div>

      <div class="sri-rico-banner__deadline">
        {% if section.settings.countdown_label != blank %}
          <div class="sri-rico-banner__deadline-label rte">
            {{ section.settings.countdown_label }}
          </div>
        {% endif %}

        <div
          class="sri-rico-countdown"
          role="timer"
          aria-live="polite"
          data-deadline="{{ section.settings.countdown_datetime | escape }}"
        >
          <div class="sri-rico-countdown__item">
            <span class="sri-rico-countdown__num" data-unit="days">0</span>
            <span class="sri-rico-countdown__label">Days</span>
          </div>
          <div class="sri-rico-countdown__item">
            <span class="sri-rico-countdown__num" data-unit="hours">0</span>
            <span class="sri-rico-countdown__label">Hours</span>
          </div>
          <div class="sri-rico-countdown__item">
            <span class="sri-rico-countdown__num" data-unit="minutes">0</span>
            <span class="sri-rico-countdown__label">Minutes</span>
          </div>
          <div class="sri-rico-countdown__item">
            <span class="sri-rico-countdown__num" data-unit="seconds">0</span>
            <span class="sri-rico-countdown__label">Seconds</span>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<script src="{{ 'sri-rico-banner.js' | asset_url }}" defer></script>

{% schema %}
{
  "name": "SRI-rico-banner",
  "tag": "section",
  "class": "section",
  "settings": [
    { "type": "image_picker", "id": "bg_image", "label": "Background image" },

    { "type": "text", "id": "heading", "label": "Heading", "default": "AWESOME!" },

    {
      "type": "richtext",
      "id": "subheading",
      "label": "Subheading (rich text)",
      "default": "<p>Your discount of $67 off has been automatically applied.</p>"
    },

    { "type": "text", "id": "primary_label", "label": "Primary button label", "default": "Order Now" },
    { "type": "url", "id": "primary_link", "label": "Primary button link" },

    { "type": "header", "content": "PayPal button" },
    { "type": "checkbox", "id": "use_native_paypal", "label": "Use native PayPal (accelerated checkout)", "default": true },
    { "type": "product", "id": "paypal_product", "label": "Product for native PayPal button" },
    { "type": "text", "id": "secondary_label", "label": "Fallback PayPal label", "default": "Pay with" },
    { "type": "url", "id": "secondary_link", "label": "Fallback PayPal link" },
    { "type": "image_picker", "id": "secondary_icon", "label": "Fallback PayPal logo" },

    {
      "type": "richtext",
      "id": "fine_print",
      "label": "Fine print (rich text)",
      "default": "<p>or 4 interest-free payments of $57.60 with</p>"
    },
    { "type": "image_picker", "id": "fine_logo", "label": "Fine print logo (e.g., Afterpay)" },

    {
      "type": "richtext",
      "id": "countdown_label",
      "label": "Countdown label (rich text)",
      "default": "<p>Valentine's Day Sale Ends at 12PM Feb 14th 2025</p>"
    },
    {
      "type": "text",
      "id": "countdown_datetime",
      "label": "Countdown end (ISO 8601)",
      "info": "Use format YYYY-MM-DDTHH:MM:SS (storeâ€™s local time). Example: 2025-02-14T12:00:00",
      "default": "2025-02-14T12:00:00"
    }
  ],
  "presets": [{ "name": "SRI-rico-banner" }]
}
{% endschema %}
